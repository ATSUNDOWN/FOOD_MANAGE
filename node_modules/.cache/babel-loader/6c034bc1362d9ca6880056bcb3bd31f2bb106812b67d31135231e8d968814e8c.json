{"ast":null,"code":"import request from \"@/utils/request.js\";\nexport default {\n  name: \"Person\",\n  data() {\n    return {\n      form: {},\n      nickName: \"\",\n      dialogVisible: false,\n      value: 0,\n      balance: 0,\n      username: ''\n    };\n  },\n  created() {\n    let str = sessionStorage.getItem(\"user\") || \"{}\";\n    this.form = JSON.parse(str);\n    this.session = JSON.parse(window.sessionStorage.getItem(\"user\"));\n    this.nickName = this.session.nickName;\n    this.username = this.session.username;\n    console.log(this.form);\n    this.balance = this.session.balance;\n    console.log(this.balance);\n  },\n  computed: {\n    countNum() {\n      return Number(this.balance) + Number(this.value);\n    }\n  },\n  methods: {\n    recharge() {\n      request.get(\"/user/recharge\", {\n        params: {\n          balance: this.countNum,\n          username: this.username\n        }\n      }).then(res => {\n        this.dialogVisible = false;\n        if (res.code === \"0\") {\n          this.$message({\n            type: \"success\",\n            message: \"充值成功\"\n          });\n        } else {\n          this.$message({\n            type: \"error\",\n            message: res.msg\n          });\n        }\n      });\n    },\n    handleClose(done) {\n      this.$confirm('确认关闭？').then(_ => {\n        done();\n      }).catch(_ => {});\n    },\n    update() {\n      request.put(\"/user\", this.form).then(res => {\n        console.log(res);\n        if (res.code === \"0\") {\n          this.$message({\n            type: \"success\",\n            message: \"更新成功\"\n          });\n          sessionStorage.setItem(\"user\", JSON.stringify(this.form));\n          // 触发Layout更新用户信息\n          this.$emit(\"userInfo\");\n        } else {\n          this.$message({\n            type: \"error\",\n            message: res.msg\n          });\n        }\n      });\n    }\n  }\n};\n\n//   name: \"Person\",\n//   components: {},\n//   data() {\n//     return {\n//       form: {},\n//       username:\"\",\n//       nickName: \"\",\n//       password: \"\",\n//       sex: \"\",\n//       age: \"\",\n//       address: \"\",\n//       search: \"\",\n//       tableData:[],\n//       dialogVisible:false\n//     };\n//   },\n//   created() {\n//     this.session = JSON.parse(window.sessionStorage.getItem(\"user\"));\n//     this.tableData = this.session;\n//     this.nickName = this.session.nickName;\n//     this.password = this.session.password;\n//     this.sex = this.session.sex;\n//     this.age = this.session.age;\n//     this.address = this.session.address;\n//     this.username = this.session.username;\n//     this.id = this.session.id;\n//   },\n//   methods: {\n//     updatePerson(){\n//       this.dialogVisible = true;\n//       this.form = {};\n//     },\n//     handleClose(done) {\n//       this.$confirm(\"确认关闭？\")\n//         .then((_) => {\n//           done();\n//         })\n//         .catch((_) => {});\n//     },\n\n//     update() {\n//       request.put(\"/user\", this.form).then((res) => {\n//         console.log(res);\n//         if (res.code === \"0\") {\n//           this.$message({\n//             type: \"success\",\n//             message: \"更新\",\n//           });\n//           sessionStorage.setItem(\"user\", JSON.stringify(this.form));\n//           this.$$emit(\"user\");\n//         } else {\n//           this.$message({\n//             type: \"error\",\n//             message: res.msg,\n//           });\n//         }\n//       });\n//     },\n//   },\n// };","map":{"version":3,"mappings":"AAsDA;AACA;EACAA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACA;IACA;IACA;IACA;IACA;IACAC;IACA;IACAA;EACA;EACAC;IACAC;MACA;IACA;EACA;EACAC;IACAC;MACAC;QACAC;UACAT;UACAC;QACA;MACA;QACA;QACA;UACA;YACAS;YACAC;UACA;QACA;UACA;YACAD;YACAC;UACA;QACA;MAEA;IACA;IACAC;MACA,uBACAC;QACAC;MACA,GACAC;IACA;IAEAC;MACAR;QACAL;QACA;UACA;YACAO;YACAC;UACA;UACAM;UACA;UACA;QACA;UACA;YACAP;YACAC;UACA;QACA;MACA;IACA;EACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","names":["name","data","form","nickName","dialogVisible","value","balance","username","created","console","computed","countNum","methods","recharge","request","params","type","message","handleClose","then","done","catch","update","sessionStorage"],"sourceRoot":"src/views","sources":["Person.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <div>\r\n      <h1 style=\"text-align: center; margin-top: 30px\">个人信息</h1>\r\n      <el-card style=\"width: 40%; margin: 50px 30%\">\r\n        <el-form ref=\"form\" :model=\"form\" label-width=\"80px\">\r\n          <el-form-item label=\"用户名\">\r\n            <el-input v-model=\"form.username\" disabled></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"昵称\">\r\n            <el-input v-model=\"form.nickName\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"年龄\">\r\n            <el-input v-model=\"form.age\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"性别\">\r\n            <el-input v-model=\"form.sex\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"地址\">\r\n            <el-input v-model=\"form.address\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"密码\">\r\n            <el-input v-model=\"form.password\" show-password></el-input>\r\n          </el-form-item>\r\n          {{this.balance}}\r\n        </el-form>\r\n        <div style=\"text-align: center\">\r\n          <el-button type=\"primary\" @click=\"update\">保存</el-button>\r\n          <el-button type=\"primary\" @click=\"dialogVisible = true\">充值</el-button>\r\n          <el-dialog\r\n            title=\"充值\"\r\n            :visible.sync=\"dialogVisible\"\r\n            width=\"30%\"\r\n            :before-close=\"handleClose\"\r\n          >\r\n            <el-form :model=\"form\" label-width=\"120px\">\r\n              <el-form-item label=\"充值额数\" >\r\n                 <el-input v-model=\"value\" style=\"width: 50%\"></el-input>\r\n              </el-form-item>\r\n            </el-form>\r\n            <span slot=\"footer\" class=\"dialog-footer\">\r\n              <el-button @click=\"dialogVisible = false\">取 消</el-button>\r\n              <el-button type=\"primary\" @click=\"recharge()\"\r\n                >确 定</el-button\r\n              >\r\n            </span>\r\n          </el-dialog>\r\n        </div>\r\n      </el-card>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport request from \"@/utils/request.js\";\r\nexport default {\r\n  name: \"Person\",\r\n  data() {\r\n    return {\r\n      form: {},\r\n      nickName: \"\",\r\n      dialogVisible:false,\r\n      value:0,\r\n      balance:0,\r\n      username:''\r\n    };\r\n  },\r\n  created() {\r\n    let str = sessionStorage.getItem(\"user\") || \"{}\";\r\n    this.form = JSON.parse(str);\r\n    this.session = JSON.parse(window.sessionStorage.getItem(\"user\"));\r\n    this.nickName = this.session.nickName;\r\n    this.username = this.session.username;\r\n    console.log(this.form);\r\n    this.balance = this.session.balance;\r\n    console.log(this.balance);\r\n  },\r\n  computed:{\r\n    countNum(){\r\n      return Number(this.balance) + Number(this.value);\r\n    }\r\n  },\r\n  methods: {\r\n    recharge(){\r\n      request.get(\"/user/recharge\",{\r\n        params:{\r\n          balance:this.countNum,\r\n          username:this.username\r\n        }\r\n      }).then((res)=>{\r\n        this.dialogVisible = false;\r\n        if (res.code === \"0\") {\r\n          this.$message({\r\n            type: \"success\",\r\n            message: \"充值成功\",\r\n          });\r\n        } else {\r\n          this.$message({\r\n            type: \"error\",\r\n            message: res.msg,\r\n          });\r\n        }\r\n\r\n      })\r\n    },\r\n    handleClose(done) {\r\n        this.$confirm('确认关闭？')\r\n          .then(_ => {\r\n            done();\r\n          })\r\n          .catch(_ => {});\r\n      }\r\n    ,\r\n    update() {\r\n      request.put(\"/user\", this.form).then((res) => {\r\n        console.log(res);\r\n        if (res.code === \"0\") {\r\n          this.$message({\r\n            type: \"success\",\r\n            message: \"更新成功\",\r\n          });\r\n          sessionStorage.setItem(\"user\", JSON.stringify(this.form));\r\n          // 触发Layout更新用户信息\r\n          this.$emit(\"userInfo\");\r\n        } else {\r\n          this.$message({\r\n            type: \"error\",\r\n            message: res.msg,\r\n          });\r\n        }\r\n      });\r\n    },\r\n  },\r\n};\r\n\r\n//   name: \"Person\",\r\n//   components: {},\r\n//   data() {\r\n//     return {\r\n//       form: {},\r\n//       username:\"\",\r\n//       nickName: \"\",\r\n//       password: \"\",\r\n//       sex: \"\",\r\n//       age: \"\",\r\n//       address: \"\",\r\n//       search: \"\",\r\n//       tableData:[],\r\n//       dialogVisible:false\r\n//     };\r\n//   },\r\n//   created() {\r\n//     this.session = JSON.parse(window.sessionStorage.getItem(\"user\"));\r\n//     this.tableData = this.session;\r\n//     this.nickName = this.session.nickName;\r\n//     this.password = this.session.password;\r\n//     this.sex = this.session.sex;\r\n//     this.age = this.session.age;\r\n//     this.address = this.session.address;\r\n//     this.username = this.session.username;\r\n//     this.id = this.session.id;\r\n//   },\r\n//   methods: {\r\n//     updatePerson(){\r\n//       this.dialogVisible = true;\r\n//       this.form = {};\r\n//     },\r\n//     handleClose(done) {\r\n//       this.$confirm(\"确认关闭？\")\r\n//         .then((_) => {\r\n//           done();\r\n//         })\r\n//         .catch((_) => {});\r\n//     },\r\n\r\n//     update() {\r\n//       request.put(\"/user\", this.form).then((res) => {\r\n//         console.log(res);\r\n//         if (res.code === \"0\") {\r\n//           this.$message({\r\n//             type: \"success\",\r\n//             message: \"更新\",\r\n//           });\r\n//           sessionStorage.setItem(\"user\", JSON.stringify(this.form));\r\n//           this.$$emit(\"user\");\r\n//         } else {\r\n//           this.$message({\r\n//             type: \"error\",\r\n//             message: res.msg,\r\n//           });\r\n//         }\r\n//       });\r\n//     },\r\n//   },\r\n// };\r\n</script>\r\n\r\n<style>\r\n</style>\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}